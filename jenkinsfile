pipeline {

   agent any
   tools {
        maven "MVN"
        jdk "JDK-11"
    }

   stages {
      stage('Verify Branch') {
         steps {
            echo "$GIT_BRANCH"
            
            
         }
      }
      stage('Build with maven') {
        steps {
            sh 'mvn clean package'
            
            }
        }
      stage('run unit testing') { 
       steps {
         sh 'mvn test'
         }

       post {
       always {
          junit(
        allowEmptyResults: true,
        testResults: '*/test-reports/.xml'
      )
      }
   }
   }

      stage('Docker Build') {
         steps {
            sh 'docker images -a'
            sh """
             
               docker build -t jenkins-pipeline .
               docker images -a
               
            """
         }
      }




    }
}